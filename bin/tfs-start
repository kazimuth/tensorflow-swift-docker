#!/bin/bash
if [ -z "$(docker ps -q -f name=tfs-daemon)" ]; then
    echo '~~ booting tensorflow-swift... ~~' 1>&2
    ## run a docker image with permissions for LLDB and the current directory mounted; let it run for 1 hour
    exec docker run -d --cap-add=SYS_PTRACE --security-opt seccomp=unconfined \
        -v "${HOME}:${HOME}" --name tfs-daemon kazimuth2/tensorflow-swift sleep 3600
    while [ -z "$(docker ps -q -f name=tfs-daemon 2>&1)" ]; do
        echo '.' 1>&2
        sleep 1 
    done
else
    echo 'found tensorflow-swift' 1>&2
fi

